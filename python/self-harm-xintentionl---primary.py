# A. John, A. Marchant, 2024.

import sys, csv, re

codes = [{"code":"U2Ay.","system":"readv2"},{"code":"U261.","system":"readv2"},{"code":"U2032","system":"readv2"},{"code":"U22z.","system":"readv2"},{"code":"U20y2","system":"readv2"},{"code":"U2zy.","system":"readv2"},{"code":"U251.","system":"readv2"},{"code":"U201z","system":"readv2"},{"code":"U2083","system":"readv2"},{"code":"U2004","system":"readv2"},{"code":"U2A3.","system":"readv2"},{"code":"U203y","system":"readv2"},{"code":"U2025","system":"readv2"},{"code":"U20Cz","system":"readv2"},{"code":"U2073","system":"readv2"},{"code":"U256.","system":"readv2"},{"code":"U2A4.","system":"readv2"},{"code":"U233.","system":"readv2"},{"code":"U20A3","system":"readv2"},{"code":"U206.","system":"readv2"},{"code":"U2y4.","system":"readv2"},{"code":"U2055","system":"readv2"},{"code":"U20C4","system":"readv2"},{"code":"U2085","system":"readv2"},{"code":"U20B4","system":"readv2"},{"code":"U29..","system":"readv2"},{"code":"U20A1","system":"readv2"},{"code":"U2z3.","system":"readv2"},{"code":"U2046","system":"readv2"},{"code":"U2023","system":"readv2"},{"code":"U286.","system":"readv2"},{"code":"U2yy.","system":"readv2"},{"code":"U25..","system":"readv2"},{"code":"U2041","system":"readv2"},{"code":"U2014","system":"readv2"},{"code":"U20C.","system":"readv2"},{"code":"U20C1","system":"readv2"},{"code":"U2066","system":"readv2"},{"code":"U292.","system":"readv2"},{"code":"U28..","system":"readv2"},{"code":"U234.","system":"readv2"},{"code":"U2011","system":"readv2"},{"code":"U281.","system":"readv2"},{"code":"U20..","system":"readv2"},{"code":"U254.","system":"readv2"},{"code":"U20C6","system":"readv2"},{"code":"U2A2.","system":"readv2"},{"code":"U2zz.","system":"readv2"},{"code":"U2024","system":"readv2"},{"code":"U221.","system":"readv2"},{"code":"U2031","system":"readv2"},{"code":"U296.","system":"readv2"},{"code":"U2006","system":"readv2"},{"code":"U2042","system":"readv2"},{"code":"U2C..","system":"readv2"},{"code":"U2D6.","system":"readv2"},{"code":"U291.","system":"readv2"},{"code":"U21..","system":"readv2"},{"code":"U2D2.","system":"readv2"},{"code":"U720.","system":"readv2"},{"code":"U20Bz","system":"readv2"},{"code":"U20B.","system":"readv2"},{"code":"U226.","system":"readv2"},{"code":"U20A.","system":"readv2"},{"code":"U206z","system":"readv2"},{"code":"U293.","system":"readv2"},{"code":"U2D5.","system":"readv2"},{"code":"U2z4.","system":"readv2"},{"code":"U2A1.","system":"readv2"},{"code":"U2082","system":"readv2"},{"code":"U2D..","system":"readv2"},{"code":"U2z6.","system":"readv2"},{"code":"U253.","system":"readv2"},{"code":"U20B6","system":"readv2"},{"code":"U2071","system":"readv2"},{"code":"U2yz.","system":"readv2"},{"code":"U235.","system":"readv2"},{"code":"U206y","system":"readv2"},{"code":"U20C2","system":"readv2"},{"code":"U25y.","system":"readv2"},{"code":"U2D3.","system":"readv2"},{"code":"U202y","system":"readv2"},{"code":"U264.","system":"readv2"},{"code":"U2053","system":"readv2"},{"code":"U294.","system":"readv2"},{"code":"U25z.","system":"readv2"},{"code":"U2y..","system":"readv2"},{"code":"U20y6","system":"readv2"},{"code":"U204.","system":"readv2"},{"code":"U2036","system":"readv2"},{"code":"U20A4","system":"readv2"},{"code":"U202z","system":"readv2"},{"code":"U20Az","system":"readv2"},{"code":"U20y.","system":"readv2"},{"code":"U2062","system":"readv2"},{"code":"U2D1.","system":"readv2"},{"code":"U2z5.","system":"readv2"},{"code":"U20B2","system":"readv2"},{"code":"U23y.","system":"readv2"},{"code":"U2054","system":"readv2"},{"code":"U2y6.","system":"readv2"},{"code":"U20Ay","system":"readv2"},{"code":"U252.","system":"readv2"},{"code":"U202.","system":"readv2"},{"code":"U2056","system":"readv2"},{"code":"U20C3","system":"readv2"},{"code":"U20yz","system":"readv2"},{"code":"U262.","system":"readv2"},{"code":"U2y1.","system":"readv2"},{"code":"U28z.","system":"readv2"},{"code":"U263.","system":"readv2"},{"code":"U2z1.","system":"readv2"},{"code":"U2z..","system":"readv2"},{"code":"U207y","system":"readv2"},{"code":"U2064","system":"readv2"},{"code":"U2012","system":"readv2"},{"code":"U203.","system":"readv2"},{"code":"U20Cy","system":"readv2"},{"code":"U21y.","system":"readv2"},{"code":"U284.","system":"readv2"},{"code":"U22..","system":"readv2"},{"code":"U23..","system":"readv2"},{"code":"U208y","system":"readv2"},{"code":"U200y","system":"readv2"},{"code":"U214.","system":"readv2"},{"code":"U2003","system":"readv2"},{"code":"U200.","system":"readv2"},{"code":"U205.","system":"readv2"},{"code":"U2065","system":"readv2"},{"code":"U20A5","system":"readv2"},{"code":"U2084","system":"readv2"},{"code":"U20yy","system":"readv2"},{"code":"U22y.","system":"readv2"},{"code":"U212.","system":"readv2"},{"code":"U2016","system":"readv2"},{"code":"U215.","system":"readv2"},{"code":"U28y.","system":"readv2"},{"code":"U23z.","system":"readv2"},{"code":"U2z2.","system":"readv2"},{"code":"U2081","system":"readv2"},{"code":"U225.","system":"readv2"},{"code":"U203z","system":"readv2"},{"code":"U2033","system":"readv2"},{"code":"U2005","system":"readv2"},{"code":"U255.","system":"readv2"},{"code":"U213.","system":"readv2"},{"code":"14K1.","system":"readv2"},{"code":"U2044","system":"readv2"},{"code":"U26z.","system":"readv2"},{"code":"U20A2","system":"readv2"},{"code":"U29z.","system":"readv2"},{"code":"U20B5","system":"readv2"},{"code":"U2075","system":"readv2"},{"code":"U265.","system":"readv2"},{"code":"U2061","system":"readv2"},{"code":"U282.","system":"readv2"},{"code":"U2035","system":"readv2"},{"code":"U2Az.","system":"readv2"},{"code":"U21z.","system":"readv2"},{"code":"U208.","system":"readv2"},{"code":"U2026","system":"readv2"},{"code":"U2001","system":"readv2"},{"code":"U2052","system":"readv2"},{"code":"U222.","system":"readv2"},{"code":"U2...","system":"readv2"},{"code":"U236.","system":"readv2"},{"code":"U2D4.","system":"readv2"},{"code":"U283.","system":"readv2"},{"code":"U20By","system":"readv2"},{"code":"U224.","system":"readv2"},{"code":"U20y1","system":"readv2"},{"code":"U2Dz.","system":"readv2"},{"code":"U26..","system":"readv2"},{"code":"U20B3","system":"readv2"},{"code":"U2Dy.","system":"readv2"},{"code":"U2A..","system":"readv2"},{"code":"U2072","system":"readv2"},{"code":"U2045","system":"readv2"},{"code":"U2015","system":"readv2"},{"code":"U2021","system":"readv2"},{"code":"U211.","system":"readv2"},{"code":"U295.","system":"readv2"},{"code":"U2076","system":"readv2"},{"code":"U204y","system":"readv2"},{"code":"U2063","system":"readv2"},{"code":"U2y2.","system":"readv2"},{"code":"U266.","system":"readv2"},{"code":"U2A6.","system":"readv2"},{"code":"U2A5.","system":"readv2"},{"code":"U232.","system":"readv2"},{"code":"U2022","system":"readv2"},{"code":"U2y5.","system":"readv2"},{"code":"U2086","system":"readv2"},{"code":"U20y3","system":"readv2"},{"code":"U20B1","system":"readv2"},{"code":"U2y3.","system":"readv2"},{"code":"U2074","system":"readv2"},{"code":"U231.","system":"readv2"},{"code":"U207z","system":"readv2"},{"code":"U205z","system":"readv2"},{"code":"U20C5","system":"readv2"},{"code":"U201y","system":"readv2"},{"code":"U216.","system":"readv2"},{"code":"U20y5","system":"readv2"},{"code":"U2002","system":"readv2"},{"code":"U20A6","system":"readv2"},{"code":"U285.","system":"readv2"},{"code":"U26y.","system":"readv2"},{"code":"U2013","system":"readv2"},{"code":"U2051","system":"readv2"},{"code":"U200z","system":"readv2"},{"code":"U2034","system":"readv2"},{"code":"U208z","system":"readv2"},{"code":"U205y","system":"readv2"},{"code":"U201.","system":"readv2"},{"code":"U223.","system":"readv2"},{"code":"U2043","system":"readv2"},{"code":"U20y4","system":"readv2"},{"code":"U207.","system":"readv2"},{"code":"U204z","system":"readv2"},{"code":"U29y.","system":"readv2"},{"code":"X82.5","system":"readv2"},{"code":"X78.3","system":"readv2"},{"code":"X81.6","system":"readv2"},{"code":"X70.9","system":"readv2"},{"code":"X63.9","system":"readv2"},{"code":"X82.9","system":"readv2"},{"code":"X81.8","system":"readv2"},{"code":"X75.8","system":"readv2"},{"code":"X79.8","system":"readv2"},{"code":"X84.6","system":"readv2"},{"code":"X75.2","system":"readv2"},{"code":"X71.5","system":"readv2"},{"code":"X63.3","system":"readv2"},{"code":"X80","system":"readv2"},{"code":"X67.6","system":"readv2"},{"code":"X74.2","system":"readv2"},{"code":"X80.4","system":"readv2"},{"code":"X60.5","system":"readv2"},{"code":"X63.5","system":"readv2"},{"code":"X74.9","system":"readv2"},{"code":"X63.2","system":"readv2"},{"code":"X62.1","system":"readv2"},{"code":"X69.8","system":"readv2"},{"code":"X70.5","system":"readv2"},{"code":"X66.5","system":"readv2"},{"code":"X71.9","system":"readv2"},{"code":"X64.1","system":"readv2"},{"code":"X63","system":"readv2"},{"code":"X83","system":"readv2"},{"code":"X72.6","system":"readv2"},{"code":"X84","system":"readv2"},{"code":"X80.8","system":"readv2"},{"code":"X72.5","system":"readv2"},{"code":"X60.3","system":"readv2"},{"code":"X70.2","system":"readv2"},{"code":"X63.4","system":"readv2"},{"code":"X63.8","system":"readv2"},{"code":"X77.5","system":"readv2"},{"code":"X78.4","system":"readv2"},{"code":"X66.9","system":"readv2"},{"code":"X78.6","system":"readv2"},{"code":"X74.1","system":"readv2"},{"code":"X69.5","system":"readv2"},{"code":"X66.4","system":"readv2"},{"code":"X60","system":"readv2"},{"code":"X64.3","system":"readv2"},{"code":"X77.8","system":"readv2"},{"code":"X66.8","system":"readv2"},{"code":"X77.3","system":"readv2"},{"code":"X81","system":"readv2"},{"code":"X60.6","system":"readv2"},{"code":"X84.9","system":"readv2"},{"code":"X79.2","system":"readv2"},{"code":"X78","system":"readv2"},{"code":"X79","system":"readv2"},{"code":"X63.6","system":"readv2"},{"code":"X69.2","system":"readv2"},{"code":"X69.6","system":"readv2"},{"code":"X82.2","system":"readv2"},{"code":"X71.3","system":"readv2"},{"code":"X61.9","system":"readv2"},{"code":"X66.3","system":"readv2"},{"code":"Y87.0","system":"readv2"},{"code":"X68.3","system":"readv2"},{"code":"X77.4","system":"readv2"},{"code":"X64.5","system":"readv2"},{"code":"X75","system":"readv2"},{"code":"X80.9","system":"readv2"},{"code":"X75.3","system":"readv2"},{"code":"X64.4","system":"readv2"},{"code":"X62.3","system":"readv2"},{"code":"X83.3","system":"readv2"},{"code":"X70.3","system":"readv2"},{"code":"X67.2","system":"readv2"},{"code":"X62.8","system":"readv2"},{"code":"X81.4","system":"readv2"},{"code":"X78.9","system":"readv2"},{"code":"X62","system":"readv2"},{"code":"X69.4","system":"readv2"},{"code":"X70.6","system":"readv2"},{"code":"X71.4","system":"readv2"},{"code":"X61.6","system":"readv2"},{"code":"X62.6","system":"readv2"},{"code":"X84.4","system":"readv2"},{"code":"X77.9","system":"readv2"},{"code":"X71.1","system":"readv2"},{"code":"X84.3","system":"readv2"},{"code":"X60.4","system":"readv2"},{"code":"X80.3","system":"readv2"},{"code":"X75.4","system":"readv2"},{"code":"X84.8","system":"readv2"},{"code":"X64.2","system":"readv2"},{"code":"X60.8","system":"readv2"},{"code":"X74.3","system":"readv2"},{"code":"X67.4","system":"readv2"},{"code":"X77.1","system":"readv2"},{"code":"X68.9","system":"readv2"},{"code":"X68.1","system":"readv2"},{"code":"X60.2","system":"readv2"},{"code":"X80.6","system":"readv2"},{"code":"X75.6","system":"readv2"},{"code":"X68.2","system":"readv2"},{"code":"X80.2","system":"readv2"},{"code":"X81.9","system":"readv2"},{"code":"X61.5","system":"readv2"},{"code":"X82.1","system":"readv2"},{"code":"X81.2","system":"readv2"},{"code":"X75.5","system":"readv2"},{"code":"X61.4","system":"readv2"},{"code":"X61","system":"readv2"},{"code":"X77","system":"readv2"},{"code":"X66.2","system":"readv2"},{"code":"X60.9","system":"readv2"},{"code":"X79.6","system":"readv2"},{"code":"X78.2","system":"readv2"},{"code":"X69","system":"readv2"},{"code":"X63.1","system":"readv2"},{"code":"X67.5","system":"readv2"},{"code":"X70.1","system":"readv2"},{"code":"X79.3","system":"readv2"},{"code":"X75.1","system":"readv2"},{"code":"X62.9","system":"readv2"},{"code":"X68.5","system":"readv2"},{"code":"X82","system":"readv2"},{"code":"X81.5","system":"readv2"},{"code":"X68.4","system":"readv2"},{"code":"X70","system":"readv2"},{"code":"X60.1","system":"readv2"},{"code":"X77.2","system":"readv2"},{"code":"X70.8","system":"readv2"},{"code":"X78.1","system":"readv2"},{"code":"X64","system":"readv2"},{"code":"X74.5","system":"readv2"},{"code":"X66.1","system":"readv2"},{"code":"X79.5","system":"readv2"},{"code":"X71.2","system":"readv2"},{"code":"X66","system":"readv2"},{"code":"X84.2","system":"readv2"},{"code":"X64.8","system":"readv2"},{"code":"X82.3","system":"readv2"},{"code":"X82.4","system":"readv2"},{"code":"X74.6","system":"readv2"},{"code":"X84.5","system":"readv2"},{"code":"X62.5","system":"readv2"},{"code":"X79.9","system":"readv2"},{"code":"X69.1","system":"readv2"},{"code":"X61.8","system":"readv2"},{"code":"X74.8","system":"readv2"},{"code":"X70.4","system":"readv2"},{"code":"X67","system":"readv2"},{"code":"X62.2","system":"readv2"},{"code":"X69.9","system":"readv2"},{"code":"X67.1","system":"readv2"},{"code":"X66.6","system":"readv2"},{"code":"X79.1","system":"readv2"},{"code":"X83.4","system":"readv2"},{"code":"X83.5","system":"readv2"},{"code":"X72.8","system":"readv2"},{"code":"X80.5","system":"readv2"},{"code":"X62.4","system":"readv2"},{"code":"X83.2","system":"readv2"},{"code":"X82.6","system":"readv2"},{"code":"X68.6","system":"readv2"},{"code":"X75.9","system":"readv2"},{"code":"X83.1","system":"readv2"},{"code":"X72.2","system":"readv2"},{"code":"X68.8","system":"readv2"},{"code":"X82.8","system":"readv2"},{"code":"X72.9","system":"readv2"},{"code":"X67.8","system":"readv2"},{"code":"X83.6","system":"readv2"},{"code":"X71.8","system":"readv2"},{"code":"X78.5","system":"readv2"},{"code":"X81.1","system":"readv2"},{"code":"X68","system":"readv2"},{"code":"X74.4","system":"readv2"},{"code":"X80.1","system":"readv2"},{"code":"X67.9","system":"readv2"},{"code":"X71","system":"readv2"},{"code":"X61.2","system":"readv2"},{"code":"X78.8","system":"readv2"},{"code":"X84.1","system":"readv2"},{"code":"X72.3","system":"readv2"},{"code":"X81.3","system":"readv2"},{"code":"X71.6","system":"readv2"},{"code":"X61.3","system":"readv2"},{"code":"X61.1","system":"readv2"},{"code":"X64.6","system":"readv2"},{"code":"X64.9","system":"readv2"},{"code":"X72","system":"readv2"},{"code":"X83.8","system":"readv2"},{"code":"X83.9","system":"readv2"},{"code":"X74","system":"readv2"},{"code":"X72.4","system":"readv2"},{"code":"X69.3","system":"readv2"},{"code":"X79.4","system":"readv2"},{"code":"X72.1","system":"readv2"},{"code":"X77.6","system":"readv2"},{"code":"X67.3","system":"readv2"},{"code":"Y87.0","system":"readv2"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('self-harm-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["self-harm-xintentionl---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["self-harm-xintentionl---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["self-harm-xintentionl---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
